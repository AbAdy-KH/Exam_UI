<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Profile - Bartihan</title>
    <link rel="stylesheet" href="style/profile.css">
</head>
<body>
    <!-- Top Navigation Bar -->
    <nav class="top-nav">
        <div class="top-nav-container">
            <a href="index.html" class="top-nav-brand">
                <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <path d="M4 19.5A2.5 2.5 0 0 1 6.5 17H20"></path>
                    <path d="M6.5 2H20v20H6.5A2.5 2.5 0 0 1 4 19.5v-15A2.5 2.5 0 0 1 6.5 2z"></path>
                </svg>
                Bartihan
            </a>
            <div class="top-nav-right">
                <a href="profile.html" class="profile-button">
                    <div class="profile-icon">U</div>
                    <span>Profile</span>
                </a>
            </div>
        </div>
    </nav>

    <div class="main">
        <div class="header">
            <h1>My Profile</h1>
            <div class="subtitle">Manage your account and view your activity</div>
        </div>

        <!-- Profile Card -->
        <div class="profile-card">
            <div class="profile-header">
                <div class="profile-avatar" id="profileAvatar">U</div>
                <div class="profile-info">
                    <div class="profile-username" id="profileUsername">Username</div>
                    <div class="profile-description" id="profileDescription">
                        This is a sample description. You can add information about yourself here.
                    </div>
                </div>
            </div>
        </div>

        <!-- Stats Section -->
        <div class="stats-section">
            <div class="stats-title">Your Statistics</div>
            <div class="stats-grid">
                <div class="stat-item">
                    <div class="stat-value" id="examCreatedCount">0</div>
                    <div class="stat-label">Exams Created</div>
                </div>
                <div class="stat-item">
                    <div class="stat-value" id="examTakenCount">0</div>
                    <div class="stat-label">Exams Taken</div>
                </div>
            </div>
        </div>

        <!-- Action Cards -->
        <div class="action-grid">
            <a href="my-exams.html" class="action-card">
                <div class="action-icon">
                    <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"></path>
                        <polyline points="14 2 14 8 20 8"></polyline>
                        <line x1="16" y1="13" x2="8" y2="13"></line>
                        <line x1="16" y1="17" x2="8" y2="17"></line>
                        <polyline points="10 9 9 9 8 9"></polyline>
                    </svg>
                </div>
                <div class="action-title">My Exams</div>
                <div class="action-description">
                    View and manage all exams you have created
                </div>
                <div class="action-arrow">
                    <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <line x1="5" y1="12" x2="19" y2="12"></line>
                        <polyline points="12 5 19 12 12 19"></polyline>
                    </svg>
                </div>
            </a>

            <a href="exam-history.html" class="action-card secondary">
                <div class="action-icon">
                    <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <circle cx="12" cy="12" r="10"></circle>
                        <polyline points="12 6 12 12 16 14"></polyline>
                    </svg>
                </div>
                <div class="action-title">Exam History</div>
                <div class="action-description">
                    Review all exams you have taken and your results
                </div>
                <div class="action-arrow">
                    <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <line x1="5" y1="12" x2="19" y2="12"></line>
                        <polyline points="12 5 19 12 12 19"></polyline>
                    </svg>
                </div>
            </a>
        </div>
    </div>

    <script>
        async function getQueryParam(param) {
            const urlParams = new URLSearchParams(window.location.search);
            return urlParams.get(param);
        
        }

        async function call_get_user_api()
        {
            let userId = await getQueryParam("id");
            console.log("User ID:", userId);
            let response = await fetch(`https://localhost:7052/api/User/${userId}`, {
                method: 'GET',
                headers: {
                    'Content-Type': 'application/json'
                }
            });

            if (response.ok) {
                let data = await response.json();
                return data;
            } else {
                console.error('Failed to fetch user data:', response.status, response.statusText);
                return null;
            }
        }

        async function loadData() {        
            const userData = await call_get_user_api();

            console.log(userData);

            // // Load user data
            document.getElementById('profileUsername').textContent = userData.userName;
            // // document.getElementById('profileDescription').textContent = userData.description;
            document.getElementById('profileDescription').textContent = "---";
            document.getElementById('profileAvatar').textContent = userData.userName.charAt(0).toUpperCase();
            document.getElementById('examCreatedCount').textContent = userData.examsCreated;
            document.getElementById('examTakenCount').textContent = userData.examsTaken;

            // // Update all profile icons
            // document.querySelectorAll('.profile-icon').forEach(icon => {
            //     icon.textContent = userData.username.charAt(0).toUpperCase();
            // });
        }

        loadData();

    </script>
</body>
</html>